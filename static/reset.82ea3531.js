import{_ as Z}from"./nuxt-link.1ccb43b1.js";import{_ as ee}from"./Nfooter.vue.5909f297.js";import{d as ae,a as se,r as i,z as k,G as te,b as _,o as F,c as le,e as c,g as a,w as l,h as v,C as oe,f,F as re,M as d,i as I,t as P,j as z}from"./entry.f3a6b6f6.js";import{a4 as ne,aI as ue,aJ as de,al as B,ap as ie,aq as ce}from"./api.75434be6.js";import{u as me}from"./counter.8b7d25a0.js";import{c as pe,a as _e,b as fe,S as ge}from"./captcha-2.41d59436.js";const he={class:"authentication"},ve={class:"container d-flex flex-column"},we={class:"row align-items-center justify-content-center no-gutters min-vh-100"},be={class:"col-12 col-md-7 col-lg-5 col-xl-4 py-md-11"},Ve={class:"card border-0 shadow-sm"},ye={class:"card-body"},ke=c("h3",{class:"text-center"},"重置密码",-1),xe=c("p",{class:"text-center mb-6"}," 请在下面输入你的电子邮件地址，并且发送验证码到你的邮箱。 ",-1),Fe={class:"text-center mb-0"},ze=ae({__name:"reset",setup(Ue){const w=me();se({title:"重置密码 - "+w.setting.title,meta:[{name:"description",content:w.setting.description},{name:"keywords",content:w.setting.keywords}]}),(()=>{ne().then(t=>{w.setting=t._rawValue.data}).catch(t=>{d.error(t)})})();const g=w.setting.register_way,x=g==="1"?"first":g=="2"?"second":"first",h=i("发送验证码"),$=i(),j=i(),n=k({email:"",email_code:"",password:"",password_c:""}),u=k({phone:"",phone_code:"",password:"",password_c:""}),M=k({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],email_code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}],password_c:[{required:!0,message:"请确认密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}]}),A=k({phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],phone_code:[{required:!0,message:"请输入手机验证码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}],password_c:[{required:!0,message:"请确认密码",trigger:"blur"},{min:8,message:"密码长度不能小于8位",trigger:"blur"}]}),U=te(),m=i(!1),D=async({values:t,errors:e})=>{if(e)return d.error("请填写正确的信息"),!1;if(n.password!=n.password_c){d.error("两次密码不一致");return}m.value=!0,ue({email:n.email,email_code:n.email_code,password:n.password}).then(s=>{if(s._rawValue.status==200){let r=60;const p=setInterval(()=>{r>0&&r<=60?(r--,h.value=r+"s"):(clearInterval(p),h.value="发送验证码")},1e3);d.success(s._rawValue.message),U.push({path:"/"}),m.value=!1}}).catch(s=>{m.value=!1,console.log(s)})},E=async({values:t,errors:e})=>{if(e)return d.error("请填写正确的信息"),!1;if(u.password!=u.password_c){d.error("两次密码不一致");return}m.value=!0,de({phone:u.phone,phone_code:u.phone_code,password:u.password}).then(s=>{if(s._rawValue.status==200){let r=60;const p=setInterval(()=>{r>0&&r<=60?(r--,h.value=r+"s"):(clearInterval(p),h.value="发送验证码")},1e3);d.success(s._rawValue.message),U.push({path:"/"}),m.value=!1}}).catch(s=>{m.value=!1,console.log(s)})},G=()=>{if(n.email==""){d.error("请填写邮箱");return}ie({email:n.email,type:"reset",verify_code:y.value}).then(t=>{t._rawValue.status==200&&d.success(t._rawValue.message)}).catch(t=>{console.log(t)})},H=()=>{if(u.phone==""){d.error("请填写手机号");return}ce({phone:u.phone,type:"reset",verify_code:y.value}).then(t=>{t._rawValue.status==200&&d.success(t._rawValue.message)}).catch(t=>{console.log(t)})},J=i([pe,_e,fe]);i("");const V=i(),L=()=>{var t;d.error("检测到非人为操作的哦！ try again"),(t=V.value)==null||t.refresh()},b=i(!1),y=i(""),q=i("email"),C=t=>{if(q.value=t,t=="email"){if(n.email==""){d.error("请填写邮箱");return}B({type:"email",email:n.email}).then(e=>{var s;e._rawValue.status==200&&((s=V.value)==null||s.refresh(),b.value=!0,y.value=e._rawValue.data)}).catch(e=>{console.log(e)})}else{if(u.phone==""){d.error("请填写手机号");return}B({type:"phone",phone:u.phone}).then(e=>{var s;e._rawValue.status==200&&((s=V.value)==null||s.refresh(),b.value=!0,y.value=e._rawValue.data)}).catch(e=>{console.log(e)})}},T=t=>{b.value=!1,q.value=="email"?G():H()},K=()=>{d.error("验证不通过")},O=()=>{d.info("刷新图形")};return(t,e)=>{const s=_("a-input"),r=_("a-form-item"),p=_("a-button"),N=_("a-space"),R=_("a-form"),S=_("a-tab-pane"),Q=_("a-tabs"),W=Z,X=ee,Y=_("a-modal");return F(),le(re,null,[c("div",he,[c("div",ve,[c("div",we,[c("div",be,[c("div",Ve,[c("div",ye,[ke,xe,a(Q,{modelValue:v(x),"onUpdate:modelValue":e[10]||(e[10]=o=>oe(x)?x.value=o:null),type:"capsule",size:"large",class:"justify-content-center mt-2"},{default:l(()=>[v(g)=="1"||v(g)=="3"?(F(),I(S,{title:"邮箱验证",key:"first"},{default:l(()=>[a(R,{onSubmit:D,ref_key:"ruleFormRef",ref:$,model:n,rules:M,class:"demo-ruleForm","status-icon":""},{default:l(()=>[a(r,{field:"email","hide-label":!0},{default:l(()=>[a(s,{modelValue:n.email,"onUpdate:modelValue":e[0]||(e[0]=o=>n.email=o),placeholder:"请填写您的邮箱"},null,8,["modelValue"])]),_:1}),a(r,{field:"email_code","hide-label":!0},{default:l(()=>[a(N,null,{default:l(()=>[a(s,{modelValue:n.email_code,"onUpdate:modelValue":e[1]||(e[1]=o=>n.email_code=o),placeholder:"请填写您的邮箱验证码"},null,8,["modelValue"]),a(p,{type:"primary",onClick:e[2]||(e[2]=o=>C("email"))},{default:l(()=>[f(P(h.value),1)]),_:1})]),_:1})]),_:1}),a(r,{field:"password","hide-label":!0},{default:l(()=>[a(s,{modelValue:n.password,"onUpdate:modelValue":e[3]||(e[3]=o=>n.password=o),placeholder:"填写您的密码"},null,8,["modelValue"])]),_:1}),a(r,{field:"password","hide-label":!0},{default:l(()=>[a(s,{modelValue:n.password_c,"onUpdate:modelValue":e[4]||(e[4]=o=>n.password_c=o),placeholder:"确认您的密码"},null,8,["modelValue"])]),_:1}),a(r,{"hide-label":!0},{default:l(()=>[a(p,{type:"primary",loading:m.value,class:"register",size:"large","html-type":"submit"},{default:l(()=>[f(" 重置密码 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})):z("",!0),v(g)=="2"||v(g)=="3"?(F(),I(S,{title:"手机验证",key:"second"},{default:l(()=>[a(R,{ref_key:"ruleFormRefP",ref:j,model:u,rules:A,class:"demo-ruleForm","status-icon":"",onSubmit:E},{default:l(()=>[a(r,{field:"phone","hide-label":!0},{default:l(()=>[a(s,{modelValue:u.phone,"onUpdate:modelValue":e[5]||(e[5]=o=>u.phone=o),placeholder:"请填写您的手机号"},null,8,["modelValue"])]),_:1}),a(r,{field:"phone_code","hide-label":!0},{default:l(()=>[a(N,null,{default:l(()=>[a(s,{modelValue:u.phone_code,"onUpdate:modelValue":e[6]||(e[6]=o=>u.phone_code=o),placeholder:"请填写您的手机验证码"},null,8,["modelValue"]),a(p,{type:"primary",onClick:e[7]||(e[7]=o=>C("phone"))},{default:l(()=>[f(P(h.value),1)]),_:1})]),_:1})]),_:1}),a(r,{field:"password","hide-label":!0},{default:l(()=>[a(s,{type:"password",modelValue:u.password,"onUpdate:modelValue":e[8]||(e[8]=o=>u.password=o),placeholder:"填写您的密码"},null,8,["modelValue"])]),_:1}),a(r,{field:"password","hide-label":!0},{default:l(()=>[a(s,{type:"password",modelValue:u.password_c,"onUpdate:modelValue":e[9]||(e[9]=o=>u.password_c=o),placeholder:"确认您的密码"},null,8,["modelValue"])]),_:1}),a(r,{"hide-label":!0},{default:l(()=>[a(p,{type:"primary",loading:m.value,class:"register",size:"large","html-type":"submit"},{default:l(()=>[f(" 重置密码 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})):z("",!0)]),_:1},8,["modelValue"]),c("p",Fe,[f("已经有账户了？"),a(W,{class:"link",to:"/"},{default:l(()=>[f("登录")]),_:1}),f(".")])])])])])]),a(X,{class:"absolute bottom-1"})]),a(Y,{class:"pic_cap",visible:b.value,"onUpdate:visible":e[11]||(e[11]=o=>b.value=o),title:"图形验证",footer:!1},{default:l(()=>[a(v(ge),{imgs:J.value,ref_key:"block",ref:V,"slider-text":"拖拽滑动",onAgain:L,onSuccess:T,onFail:K,class:"m-auto",onRefresh:O},null,8,["imgs"])]),_:1},8,["visible"])],64)}}});export{ze as default};
