import{d as K,r as h,z as R,H as Q,a4 as Z,o as $,c as P,e as g,n as N,j as _,y as L,t as x,ap as ee,aq as te}from"./entry.f3a6b6f6.js";const T=Math.PI;function U(e,t){return e+t}function ne(e){return e*e}function q(e,t,n,s,l,c){e.beginPath(),e.moveTo(t,n),e.arc(t+s/2,n-l+2,l,.72*T,2.26*T),e.lineTo(t+s,n),e.arc(t+s+l-2,n+s/2,l,1.21*T,2.78*T),e.lineTo(t+s,n+s),e.lineTo(t,n+s),e.arc(t+l-2,n+s/2,l+.4,2.76*T,1.24*T,!0),e.lineTo(t,n),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[c](),e.globalCompositeOperation="destination-over"}function se(e,t){const n=document.createElement("img");return n.crossOrigin="Anonymous",n.onload=t,n.onerror=()=>{n.src=A(e)},n.src=A(e),n}function X(e,t){return Math.round(Math.random()*(t-e)+e)}function A(e){const t=e.length;return t>0?e[X(0,t-1)]:"https://source.unsplash.com/300x150/?book,library"}function oe(e,t,n={leading:!0,trailing:!0}){const{leading:s,trailing:l,resultCallback:c}=n;let a=0,m=null;const C=function(...r){return new Promise((u,v)=>{const o=new Date().getTime();!a&&!s&&(a=o);const i=t-(o-a);if(i<=0){m&&(clearTimeout(m),m=null);const f=e.apply(this,r);c&&c(f),u(f),a=o;return}l&&!m&&(m=setTimeout(()=>{m=null,a=s?new Date().getTime():0;const f=e.apply(this,r);c&&c(f),u(f)},i))})};return C.cancel=function(){m&&clearTimeout(m),m=null,a=0},C}function ae(){const e=R({x:0,y:0}),t=h(!1),n=h(!1),s=h(0),l=h([]);return{origin:e,success:t,isMouseDown:n,timestamp:s,trail:l,start:r=>{t.value||(r instanceof MouseEvent?(e.x=r.clientX,e.y=r.clientY):(e.x=r.changedTouches[0].pageX,e.y=r.changedTouches[0].pageY),n.value=!0,s.value=Date.now())},move:(r,u,v)=>{if(!n.value)return!1;let o=0,i=0;if(u instanceof MouseEvent?(o=u.clientX-e.x,i=u.clientY-e.y):(o=u.changedTouches[0].pageX-e.x,i=u.changedTouches[0].pageY-e.y),o<0||o+38>=r)return!1;v(o),l.value.push(i)},end:(r,u)=>{if(!n.value||(n.value=!1,(r instanceof MouseEvent?r.clientX:r.changedTouches[0].pageX)===e.x))return!1;s.value=Date.now()-s.value,u(s.value)},verify:(r,u,v)=>{const o=l.value,i=o.reduce(U)/o.length,f=o.map(S=>S-i),k=Math.sqrt(f.map(ne).reduce(U)/o.length),E=parseInt(r);return v=v<=1?1:v>10?10:v,{spliced:Math.abs(E-u)<=v,TuringTest:i!==k}}}}var le=(e,t)=>{const n=e.__vccOpts||e;for(const[s,l]of t)n[s]=l;return n};const ie=K({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:n,l:s,r:l,w:c,h:a,accuracy:m,interval:C}=e,r=h(!0),u=h(0),v=h(0),o=R({containerActive:!1,containerSuccess:!1,containerFail:!1}),i=R({iconCls:"arrow-right",width:"0",left:"0"}),f=h(),k=h(),E=h(),S=h();let M;const{success:I,start:Y,move:z,end:O,verify:j}=ae(),F=()=>{var d,p;I.value=!1,o.containerActive=!1,o.containerSuccess=!1,o.containerFail=!1,i.iconCls="arrow-right",i.left="0",i.width="0",f.value.style.left="0",(d=S.value)==null||d.clearRect(0,0,c,a),(p=k.value)==null||p.clearRect(0,0,c,a),f.value.width=c,M.src=A(n)},H=()=>{F(),t("refresh")};function W(d){i.left=d+"px";let p=(c-40-20)/(c-40)*d;f.value.style.left=p+"px",o.containerActive=!0,i.width=d+"px"}function G(d){const{spliced:p,TuringTest:y}=j(f.value.style.left,u.value,m);if(p){if(m===-1){o.containerSuccess=!0,i.iconCls="success",I.value=!0,t("success",d);return}y?(o.containerSuccess=!0,i.iconCls="success",I.value=!0,t("success",d)):(o.containerFail=!0,i.iconCls="fail",t("again"))}else o.containerFail=!0,i.iconCls="fail",t("fail"),setTimeout(()=>{F()},1e3)}const B=oe(d=>{z(c,d,W)},C),D=d=>{O(d,G)};return Q(()=>{var d,p;const y=(d=E.value)==null?void 0:d.getContext("2d"),w=(p=f.value)==null?void 0:p.getContext("2d");S.value=y,k.value=w,M=se(n,()=>{r.value=!1;const b=s+l*2+3;if(u.value=X(b+10,c-(b+10)),v.value=X(10+l*2,a-(b+10)),y&&w){q(y,u.value,v.value,s,l,"fill"),q(w,u.value,v.value,s,l,"clip"),y.drawImage(M,0,0,c,a),w.drawImage(M,0,0,c,a);const V=v.value-l*2-1,J=w.getImageData(u.value,V,b,b);f.value.width=b,w.putImageData(J,0,V)}}),document.addEventListener("mousemove",B),document.addEventListener("mouseup",D)}),Z(()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",D)}),{block:f,canvas:E,loadBlock:r,containerCls:o,sliderBox:i,refresh:H,sliderDown:Y,touchStartEvent:Y,touchMoveEvent:B,touchEndEvent:D}}}),re=e=>(ee("data-v-f61c42f2"),e=e(),te(),e),ce=["width","height"],ue=re(()=>g("i",{class:"iconfont icon-refresh"},null,-1)),de=[ue],fe=["width","height"],ve={class:"slide-verify-slider-text"};function me(e,t,n,s,l,c){return $(),P("div",{id:"slideVerify",class:"slide-verify",style:L({width:e.w+"px"}),onselectstart:"return false;"},[g("div",{class:N({"slider-verify-loading":e.loadBlock})},null,2),g("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,ce),e.show?($(),P("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...a)=>e.refresh&&e.refresh(...a))},de)):_("",!0),g("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,fe),g("div",{class:N(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[g("div",{class:"slide-verify-slider-mask",style:L({width:e.sliderBox.width})},[g("div",{class:"slide-verify-slider-mask-item",style:L({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...a)=>e.sliderDown&&e.sliderDown(...a)),onTouchstart:t[2]||(t[2]=(...a)=>e.touchStartEvent&&e.touchStartEvent(...a)),onTouchmove:t[3]||(t[3]=(...a)=>e.touchMoveEvent&&e.touchMoveEvent(...a)),onTouchend:t[4]||(t[4]=(...a)=>e.touchEndEvent&&e.touchEndEvent(...a))},[g("i",{class:N(["slide-verify-slider-mask-item-icon","iconfont",`icon-${e.sliderBox.iconCls}`])},null,2)],36)],4),g("span",ve,x(e.sliderText),1)],2)],4)}var pe=le(ie,[["render",me],["__scopeId","data-v-f61c42f2"]]);const ge=""+new URL("captcha-1.5ea202d1.png",import.meta.url).href,ye=""+new URL("captcha.2ac7aed7.png",import.meta.url).href,we=""+new URL("captcha-2.c111780a.png",import.meta.url).href;export{pe as S,ye as a,we as b,ge as c};
