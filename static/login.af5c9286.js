import{_ as He}from"./nuxt-link.1ccb43b1.js";import{_ as Ae}from"./Nfooter.vue.5909f297.js";import{ai as Ee,aj as Pe,ak as De,a4 as Ge,al as ie,am as Je,an as ne,ao as Ze,ap as Ke,aq as Oe}from"./api.75434be6.js";import{d as Qe,r as i,z as C,u as G,G as We,H as Xe,J as Ye,b as c,o as f,c as w,e as o,h as _,t as q,g as a,w as t,F as ue,M as d,f as m,i as T,l as ea,j,C as aa}from"./entry.f3a6b6f6.js";import{I as ta,_ as _e}from"./safe_login.a991f1f7.js";import{I as de,a as sa,_ as la}from"./wechat.f8f675e5.js";import{u as oa}from"./counter.8b7d25a0.js";import{c as ra,a as ia,b as na,S as ua}from"./captcha-2.41d59436.js";import{I as da}from"./index.8ed57307.js";import{I as J}from"./index.e62e449a.js";import{I as ce}from"./index.25e3049d.js";const ca={class:"login_reg_portal"},_a={class:"logo flex align-items-center"},ma=["src"],pa={class:"mb-0 ml-1"},fa=["innerHTML"],ga={class:"dialog-footer"},va={class:"web_login"},ha={class:"left_image"},wa=["src"],ba={class:"position-absolute bottom-28 text-white w-100 text-center"},ya={class:"position-absolute bottom-20 text-white w-100 text-center"},ka={class:"form_right"},Va={key:0,class:"card login_card pt-3 border-0"},xa={class:"card-body"},Fa=o("img",{src:_e,alt:"",class:"w-28 m-auto mb-2"},null,-1),Ca=o("p",{class:"text-center mb-6"},"登录自主用户，开始聊天",-1),Ia={class:"form-group d-flex justify-content-between mb-2"},Ua={key:0,class:"mt-6"},qa=o("div",{class:"relative"},[o("div",{class:"absolute inset-0 flex items-center"},[o("div",{class:"w-full border-t border-gray-300"})]),o("div",{class:"relative flex justify-center text-sm"},[o("span",{class:"bg-white px-2 text-gray-500"},"第三方登录")])],-1),La={key:0,class:"mt-3 grid grid-cols-1 gap-1 mb-3"},$a=o("span",{class:"sr-only"},"Sign in with Twitter",-1),Ma=o("svg",{t:"1684751208419",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"23618",width:"26",height:"26"},[o("path",{d:"M512 512m-447.9 0a447.9 447.9 0 1 0 895.8 0 447.9 447.9 0 1 0-895.8 0Z",fill:"#00C785","p-id":"23619"}),o("path",{d:"M741.6 567.5c0-63.7-63.7-115.5-135.3-115.5-75.9 0-135.5 51.9-135.5 115.5 0 63.8 59.6 115.5 135.5 115.5 15.9 0 31.9-4 47.8-7.9l43.7 24-12-39.8c32-24 55.8-56 55.8-91.8z m-179.3-19.9c-7.9 0-15.9-7.9-15.9-15.9 0-7.9 7.9-15.9 15.9-15.9 12 0 20 7.9 20 15.9s-8 15.9-20 15.9z m87.7 0c-7.9 0-15.8-7.9-15.8-15.9 0-7.9 7.9-15.9 15.8-15.9 12 0 19.9 7.9 19.9 15.9 0.1 8-8.1 15.9-19.9 15.9z m0 0",fill:"#FFFFFF","p-id":"23620"}),o("path",{d:"M593.1 437.9c5.2 0 10.5 0.4 15.7 0.9-14-65.6-84.1-114.2-164.1-114.2-89.4 0-162.7 60.9-162.7 138.3 0 44.7 24.3 81.4 65 109.9l-16.2 49 56.9-28.6c20.4 4 36.7 8.1 56.9 8.1 5 0 10.1-0.2 15.1-0.7-3.2-10.8-5-22.3-5-34.1 0.1-70.9 61.2-128.6 138.4-128.6z m-87.5-44.1c12.2 0 20.3 8.1 20.3 20.4 0 12.2-8.1 20.3-20.3 20.3-12.3 0-24.5-8.1-24.5-20.3 0.2-12.3 12.4-20.4 24.5-20.4z m-113.9 40.7c-12.3 0-24.5-8.1-24.5-20.3 0-12.3 12.2-20.4 24.5-20.4s20.4 8.1 20.4 20.4c0 12-8.1 20.3-20.4 20.3z m0 0",fill:"#FFFFFF","p-id":"23621"})],-1),Ra=[$a,Ma],Sa={class:"text-center mb-0"},za={key:1,class:"card login_card border-0"},Na={class:"card-body"},Ta=o("img",{src:la,alt:"",class:"m-auto mb-2"},null,-1),ja=o("p",{class:"text-center mb-6"},"打开微信[扫一扫]登录",-1),Ba={key:2,class:"card register_card pt-3 border-0"},Ha={class:"card-body"},Aa=o("img",{src:_e,alt:"",class:"w-28 m-auto mb-2"},null,-1),Ea=o("p",{class:"text-center mb-6"},"创建一个免费账户",-1),Pa={class:"text-center mb-0"},lt=Qe({__name:"login",setup(Da){const b=oa(),L=i(!0),$=i(),me=()=>{$.value="",L.value=!1},M=()=>{$.value="",B.value=!1,L.value=!0};i("");const R=i(),pe=s=>{},I=i(!1),S=i(""),Z=i("email"),K=s=>{if(Z.value=s,s=="email"){if(n.email==""){d.error("请填写邮箱");return}ie({type:"email",email:n.email}).then(e=>{var r;e._rawValue.status==200&&((r=R.value)==null||r.refresh(),I.value=!0,S.value=e._rawValue.data)}).catch(e=>{console.log(e)})}else{if(u.phone==""){d.error("请填写手机号");return}ie({type:"phone",phone:u.phone}).then(e=>{var r;e._rawValue.status==200&&((r=R.value)==null||r.refresh(),I.value=!0,S.value=e._rawValue.data)}).catch(e=>{console.log(e)})}},fe=s=>{I.value=!1,Z.value=="email"?$e():Me()},ge=()=>{var s;d.error("检测到非人为操作的哦！ try again"),(s=R.value)==null||s.refresh()},ve=()=>{d.error("验证不通过")},he=()=>{d.info("刷新图形")};i(""),i("");const we=i(),y=C({email:"",password:""});C({email:[{required:!0,message:"请输入邮箱或手机号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]});const z=i(!1),O=G("token",{maxAge:60*60*24*2}),Q=G("user_info"),W=We(),X=G("message"),be=async({values:s,errors:e})=>{if(e)return d.error("请填写登录信息"),!1;z.value=!0,Je({email:y.email,password:y.password}).then(r=>{z.value=!1,r._rawValue.status==200&&(X.value="",O.value=r._rawValue.token,Q.value=r._rawValue.user_info,d.success(r._rawValue.message),W.push("/"))}).catch(r=>{z.value=!1})},Y=i(),B=i(!1),ee=()=>{L.value=!1,B.value=!0,Ee({type:"login"}).then(s=>{$.value=s._rawValue.data,Y.value=s._rawValue.id;let e=setInterval(()=>{Pe({id:Y.value}).then(r=>{r._rawValue.status==200&&(clearInterval(e),X.value="",O.value=r._rawValue.token,Q.value=r._rawValue.user_info,d.success(r._rawValue.message),W.push("/"))}).catch(r=>{clearInterval(e)})},5e3)}).catch(s=>{d.error(s)})},v=i(b.setting.register_way?b.setting.register_way:"1");v.value==4&&ee();const ye=i(),ke=i(),n=C({email:"",password:"",email_code:"",invite_code:"",check_xieyi:!1}),u=C({phone:"",password:"",phone_code:"",invite_code:"",check_xieyi:!1});{const s=new URLSearchParams(window.location.search);s.get("invite_code")&&(n.invite_code=s.get("invite_code"),u.invite_code=s.get("invite_code"))}const Ve=C({phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{match:/^1[3456789]\d{9}$/,message:"请输入正确的手机号",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],phone_code:[{required:!0,message:"请输入手机验证码",trigger:"blur"}]}),ae=()=>{N.value=!0,Ie()},xe=C({email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],email_code:[{required:!0,message:"请输入邮箱验证码",trigger:"blur"}]}),Fe=i([ra,ia,na]),h=i(!1),Ce=async({values:s,errors:e})=>{if(e)return d.error("请补全注册信息"),!1;if(n.check_xieyi==!1){d.error("请同意用户协议");return}h.value=!0,ne({email:n.email,password:n.password,email_code:n.email_code,invite_code:n.invite_code}).then(r=>{r._rawValue.status==200&&(d.success(r._rawValue.message),M(),h.value=!1)}).catch(r=>{h.value=!1})},N=i(!1),H=i({}),U=i(!1),Ie=()=>{U.value=!0,Ze().then(s=>{H.value=s._rawValue.data,U.value=!1}).catch(s=>{console.log(s),U.value=!1})},Ue=()=>{N.value=!1,n.check_xieyi=!0,u.check_xieyi=!0},qe=async({values:s,errors:e})=>{if(e)return d.error("请补全注册信息"),!1;if(u.check_xieyi==!1){d.error("请同意用户协议");return}h.value=!0,ne({phone:u.phone,password:u.password,phone_code:u.phone_code,invite_code:u.invite_code}).then(r=>{r._rawValue.status==200&&(d.success(r._rawValue.message),M(),h.value=!1)}).catch(r=>{h.value=!1})},V=i("发送验证码"),g=i(!1),A=v==="1"?"first":v=="2"?"second":"first",te=i([]),Le=()=>{De().then(s=>{te.value=s._rawValue.data}).catch(s=>{console.log(s)})};(()=>{Ge().then(s=>{b.setting=s._rawValue.data}).catch(s=>{d.error(s)})})(),Xe(async()=>{await Ye(),Le()});const $e=()=>{if(n.email==""){d.error("请填写邮箱");return}g.value=!0,Ke({email:n.email,verify_code:S.value}).then(s=>{if(s._rawValue.status==200){d.success(s._rawValue.message);let e=60;const r=setInterval(()=>{if(e<=0){V.value="发送验证码",g.value=!1,clearInterval(r);return}V.value=e+"s",g.value=!0,e--},1e3)}}).catch(s=>{g.value=!1,console.log(s)})},Me=()=>{if(u.phone==""){d.error("请填写手机号");return}g.value=!0,Oe({phone:u.phone,verify_code:S.value}).then(s=>{if(s._rawValue.status==200){d.success(s._rawValue.message);let e=60;const r=setInterval(()=>{if(e<=0){V.value="发送验证码",g.value=!1,clearInterval(r);return}V.value=e+"s",g.value=!0,e--},1e3)}}).catch(s=>{g.value=!1,console.log(s)})};return(s,e)=>{const r=c("a-skeleton-line"),Re=c("a-space"),Se=c("a-skeleton"),x=c("a-button"),se=c("a-modal"),ze=c("a-carousel-item"),Ne=c("a-carousel"),F=c("a-col"),k=c("a-input"),p=c("a-form-item"),E=c("a-input-password"),le=He,P=c("a-form"),Te=c("a-image"),D=c("a-row"),oe=c("a-checkbox"),re=c("a-tab-pane"),je=c("a-tabs"),Be=Ae;return f(),w(ue,null,[o("div",ca,[o("div",_a,[o("img",{src:_(b).setting.logo,alt:""},null,8,ma),o("h5",pa,q(_(b).setting.title),1)]),a(se,{visible:N.value,"onUpdate:visible":e[1]||(e[1]=l=>N.value=l),title:H.value.title,class:"dialog_login_of"},{footer:t(()=>[o("span",ga,[a(x,{type:"primary",onClick:e[0]||(e[0]=l=>Ue())},{default:t(()=>[m(" 同意协议 ")]),_:1})])]),default:t(()=>[U.value?(f(),T(Se,{key:0,animation:U.value},{default:t(()=>[a(Re,{direction:"vertical",style:{width:"100%"},size:"large"},{default:t(()=>[a(r,{rows:3})]),_:1})]),_:1},8,["animation"])):(f(),w("div",{key:1,innerHTML:H.value.description},null,8,fa))]),_:1},8,["visible","title"]),o("div",va,[a(D,{gutter:20},{default:t(()=>[a(F,{span:"12",class:"mb_left_image"},{default:t(()=>[o("div",ha,[a(Ne,{style:{width:"100%",height:"540px"},"default-current":2,onChange:pe,"animation-name":"fade","show-arrow":"never","indicator-type":"line","auto-play":!0},{default:t(()=>[(f(!0),w(ue,null,ea(te.value,(l,Ja)=>(f(),T(ze,null,{default:t(()=>[o("img",{src:l.image,style:{width:"100%"}},null,8,wa),o("h4",ba,q(l.title),1),o("span",ya,q(l.description),1)]),_:2},1024))),256))]),_:1})])]),_:1}),a(F,{span:"12"},{default:t(()=>[o("div",ka,[L.value&&v.value!=4?(f(),w("div",Va,[o("div",xa,[Fa,Ca,a(P,{ref_key:"ruleFormRefLogin",ref:we,model:y,class:"demo-ruleForm","status-icon":"",onSubmit:be},{default:t(()=>[a(p,{"hide-label":!0,field:"email",rules:[{required:!0,message:"邮箱或手机号不得为空"}]},{default:t(()=>[a(k,{modelValue:y.email,"onUpdate:modelValue":e[2]||(e[2]=l=>y.email=l),placeholder:"输入你的邮箱/手机号"},{prefix:t(()=>[a(_(da))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,field:"password",rules:[{required:!0,message:"密码不得为空"},{minLength:6,message:"必须输入大于6个字符"}]},{default:t(()=>[a(E,{modelValue:y.password,"onUpdate:modelValue":e[3]||(e[3]=l=>y.password=l),placeholder:"输入你的密码"},{prefix:t(()=>[a(_(J))]),_:1},8,["modelValue"])]),_:1}),o("div",Ia,[a(le,{class:"link",href:"/users/reset"},{default:t(()=>[m("忘记密码")]),_:1})]),a(x,{loading:z.value,type:"primary","html-type":"submit",class:"login mb-2"},{default:t(()=>[m(" 登录 ")]),_:1},8,["loading"])]),_:1},8,["model"]),_(b).setting.three_login_open=="1"?(f(),w("div",Ua,[qa,_(b).setting.wechat_login=="1"?(f(),w("div",La,[o("div",null,[o("div",{onClick:e[4]||(e[4]=l=>ee()),class:"inline-flex w-full justify-center rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-500 shadow-sm hover:bg-gray-50"},Ra)])])):j("",!0)])):j("",!0),o("p",Sa,[m("还没有账户？ "),o("span",{class:"link cursor-pointer",onClick:e[5]||(e[5]=l=>me())},"注册一个"),m(" . ")])])])):B.value||v.value==4?(f(),w("div",za,[o("div",Na,[Ta,ja,a(Te,{src:$.value,alt:""},null,8,["src"])]),a(le,{onClick:M,class:"text-center cursor-pointer"},{default:t(()=>[m("返回登录")]),_:1})])):(f(),w("div",Ba,[o("div",Ha,[Aa,Ea,a(je,{type:"capsule",modelValue:_(A),"onUpdate:modelValue":e[20]||(e[20]=l=>aa(A)?A.value=l:null),class:"demo-tabs reg_demo_tabs"},{default:t(()=>[v.value=="1"||v.value=="3"?(f(),T(re,{title:"邮箱注册",key:"first"},{default:t(()=>[a(P,{ref_key:"ruleFormRef",ref:ye,model:n,rules:xe,class:"demo-ruleForm","status-icon":"",onSubmit:Ce},{default:t(()=>[a(p,{"hide-label":!0,"hide-asterisk":!0,field:"email"},{default:t(()=>[a(k,{modelValue:n.email,"onUpdate:modelValue":e[6]||(e[6]=l=>n.email=l),placeholder:"请填写您的邮箱"},{prefix:t(()=>[a(_(ta))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"email_code"},{default:t(()=>[a(D,{gutter:20,class:"w-100"},{default:t(()=>[a(F,{span:"18"},{default:t(()=>[a(k,{modelValue:n.email_code,"onUpdate:modelValue":e[7]||(e[7]=l=>n.email_code=l),placeholder:"邮箱验证码"},{prefix:t(()=>[a(_(ce))]),_:1},8,["modelValue"])]),_:1}),a(F,{span:"6"},{default:t(()=>[a(x,{loading:g.value,type:"primary",onClick:e[8]||(e[8]=l=>K("email"))},{default:t(()=>[m(q(V.value),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"password"},{default:t(()=>[a(E,{modelValue:n.password,"onUpdate:modelValue":e[9]||(e[9]=l=>n.password=l),placeholder:"填写您的密码"},{prefix:t(()=>[a(_(J))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"invite_code",class:"mb-2"},{default:t(()=>[a(k,{modelValue:n.invite_code,"onUpdate:modelValue":e[10]||(e[10]=l=>n.invite_code=l),placeholder:"填写您的邀请码（可选）"},{prefix:t(()=>[a(_(de))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"check_xieyi",class:"mb-2 mt-0"},{default:t(()=>[a(oe,{type:"check_xieyi",modelValue:n.check_xieyi,"onUpdate:modelValue":e[11]||(e[11]=l=>n.check_xieyi=l),onClick:e[12]||(e[12]=l=>ae())},{default:t(()=>[m(" 同意《用户协议》 ")]),_:1},8,["modelValue"])]),_:1}),a(x,{type:"primary",loading:h.value,class:"register w-100 mb-2","html-type":"submit"},{default:t(()=>[m(" 注册 ")]),_:1},8,["loading"])]),_:1},8,["model","rules"])]),_:1})):j("",!0),v.value=="2"||v.value=="3"?(f(),T(re,{title:"手机注册",key:"second"},{default:t(()=>[a(P,{ref_key:"ruleFormRefs",ref:ke,model:u,rules:Ve,class:"demo-ruleForm",onSubmit:qe,"status-icon":""},{default:t(()=>[a(p,{"hide-label":!0,"hide-asterisk":!0,field:"phone"},{default:t(()=>[a(k,{modelValue:u.phone,"onUpdate:modelValue":e[13]||(e[13]=l=>u.phone=l),placeholder:"请填写您的手机号"},{prefix:t(()=>[a(_(sa))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"phone_code"},{default:t(()=>[a(D,{gutter:20,class:"w-100"},{default:t(()=>[a(F,{span:"18"},{default:t(()=>[a(k,{modelValue:u.phone_code,"onUpdate:modelValue":e[14]||(e[14]=l=>u.phone_code=l),placeholder:"请填写您的手机验证码"},{prefix:t(()=>[a(_(ce))]),_:1},8,["modelValue"])]),_:1}),a(F,{span:"6"},{default:t(()=>[a(x,{loading:g.value,type:"primary",onClick:e[15]||(e[15]=l=>K("phone"))},{default:t(()=>[m(q(V.value),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"password"},{default:t(()=>[a(E,{modelValue:u.password,"onUpdate:modelValue":e[16]||(e[16]=l=>u.password=l),placeholder:"填写您的密码"},{prefix:t(()=>[a(_(J))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"invite_code",class:"mb-2"},{default:t(()=>[a(k,{modelValue:u.invite_code,"onUpdate:modelValue":e[17]||(e[17]=l=>u.invite_code=l),placeholder:"填写您的邀请码（可选）"},{prefix:t(()=>[a(_(de))]),_:1},8,["modelValue"])]),_:1}),a(p,{"hide-label":!0,"hide-asterisk":!0,field:"check_xieyi",class:"mb-2 mt-0"},{default:t(()=>[a(oe,{modelValue:u.check_xieyi,"onUpdate:modelValue":e[18]||(e[18]=l=>u.check_xieyi=l),onClick:e[19]||(e[19]=l=>ae())},{default:t(()=>[m(" 同意《用户协议》 ")]),_:1},8,["modelValue"])]),_:1}),a(x,{type:"primary",loading:h.value,class:"register w-100 mb-2","html-type":"submit"},{default:t(()=>[m(" 注册 ")]),_:1},8,["loading"])]),_:1},8,["model","rules"])]),_:1})):j("",!0)]),_:1},8,["modelValue"]),o("p",Pa,[m("已经有账户了? "),o("span",{class:"link cursor-pointer",onClick:e[21]||(e[21]=l=>M())},"登录"),m(".")])])]))])]),_:1})]),_:1})]),a(Be,{class:"absolute bottom-1"})]),a(se,{class:"pic_cap",visible:I.value,"onUpdate:visible":e[22]||(e[22]=l=>I.value=l),title:"图形验证",footer:!1},{default:t(()=>[a(_(ua),{imgs:Fe.value,ref_key:"block",ref:R,"slider-text":"拖拽滑动",onAgain:ge,onSuccess:fe,onFail:ve,class:"m-auto",onRefresh:he},null,8,["imgs"])]),_:1},8,["visible"])],64)}}});export{lt as default};
